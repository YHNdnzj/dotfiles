#!/bin/bash -e
nspawn="pkexec systemd-nspawn -M arch-nspawn"

boot() {
    exec $nspawn --boot
}

run() {
    set -x
    exec $nspawn --as-pid2 --user=yhndnzj --rlimit=RLIMIT_NOFILE=1024:524288 "$@"
}

case $1 in
    boot)
        boot
        ;;
    run)
        shift
        run "$@"
        ;;
    *)
        echo "usage: $0 {boot|run [option] command}"
        exit 1
        ;;
esac
exit 0
