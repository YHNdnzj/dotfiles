#!/bin/bash -e

cd "$HOME/.config/sway/env"
envfiles=(*.sh)
set -x
for envfile in "${envfiles[@]}"
do
    source "$envfile"
done
set +x
cd "$HOME"

for card in /dev/dri/card*
do
    if (( $(udevadm info -an "$card" | grep boot_vga | rev | cut -c 2) )); then
        WLR_DRM_DEVICES="$card" exec /usr/bin/sway --unsupported-gpu
    fi
done

echo "No available GPU found!" >&2
exit 1
